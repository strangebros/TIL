# 11장 결제 시스템

# 1단계: 문제 이해 및 설계 범위 확정

1. **결제 시스템의 정의 및 중요성**
    - 결제 시스템은 금전적 가치 이전을 통해 금융 거래를 정산하는 데 사용되는 모든 제도, 절차, 기술을 포함함
    - 전자상거래의 폭발적인 성장에 필수적이며, 작은 실수도 큰 매출 손실로 이어질 수 있는 부담스러운 시스템임
2. **설계 범위 확정 (전자상거래 환경 가정)**
    - **대상 애플리케이션:** 아마존닷컴과 같은 전자상거래 애플리케이션의 결제 백엔드를 구축하는 것을 가정함
    - **지원 결제 방법:** 실생활에서 사용 가능한 모든 옵션을 지원해야 하지만, 이번 면접에서는 **신용 카드 결제**만 처리하는 것으로 한정함
    - **결제 처리 주체:** 신용 카드 데이터의 보안 및 법규 준수(PCI DSS 등) 문제로 인해, 민감한 데이터 처리는 스트라이프(Stripe) 같은 **전문 결제 처리 업체(PSP)**에 의존함
    - **국제 지원:** 전 세계적으로 사용될 수 있는 애플리케이션이지만, 면접에서는 **하나의 통화**만 사용한다고 가정함
    - **규모:** 하루 **100만 건의 거래**가 이루어진다고 가정함 (초당 약 10TPS)
    - **추가 요구사항:** 판매자에게 매월 지급 대금을 정산하는 절차(Pay-out)를 지원해야 함
3. **기능 및 비기능 요구사항**
    - **기능 요구사항:** 대금 수신, 대금 정산
    - **비기능 요구사항:** 신뢰성 및 내결함성, 내부 서비스 간 조정 프로세스

# 2단계: 개략적 설계안 제시 및 동의 구하기

## 2.1. 결제 자금의 흐름 (Pay-in 및 Pay-out)

1. **대금 수신 (Pay-in) 흐름**
    - 구매자가 주문하면 돈이 아마존의 은행 계좌로 들어옴
    - 이 돈의 소유권은 대부분 판매자에게 있으며, 아마존은 수수료를 받고 자금 관리자 역할만 수행함
2. **대금 정산 (Pay-out) 흐름**
    - 제품이 배송되는 등 조건이 충족되면, 판매 대금에서 수수료를 제외한 잔액이 판매자의 은행 계좌로 지급됨
